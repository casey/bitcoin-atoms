#!/usr/bin/env bash

set -euxo pipefail

rm -rf benchmark
mkdir tmp

export CARGO_PROFILE_RELEASE_DEBUG=true
export RUST_LOG=info

for height in 100 250 500 1000 2000; do
  sudo --preserve-env=CARGO_PROFILE_RELEASE_DEBUG,RUST_LOG \
    cargo flamegraph \
    --deterministic \
    --bin ord \
    --output benchmark/$height.svg \
    -- \
    --chain signet \
    --data-dir benchmark \
    --height-limit $height \
    index
done
